<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>TWI_DEMO: i2c.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>i2c.h File Reference</h1>Driver for I2C bus communications.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;avr/io.h&gt;</code><br>
<code>#include &lt;stdint.h&gt;</code><br>
<code>#include &lt;util/delay.h&gt;</code><br>
<code>#include &quot;<a class="el" href="rbuff_8h.html">rbuff.h</a>&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structi2c__data__struct__t.html">i2c_data_struct_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used to write a data byte to the register of the slave device.  <a href="structi2c__data__struct__t.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1d898c0a79453b0d6cea455f79776a00"></a><!-- doxytag: member="i2c.h::I2C_ADDRESS_IN_ARRAY" ref="1d898c0a79453b0d6cea455f79776a00" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#1d898c0a79453b0d6cea455f79776a00">I2C_ADDRESS_IN_ARRAY</a>&nbsp;&nbsp;&nbsp;0xFF</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">See <a class="el" href="i2c_8h.html#f83055314c891d34f14dcc9db3e03b3b" title="A master read from DeviceAddress of n number of bytes to *ReturnData.">i2c_read()</a>. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dc6e9d96bc63bb6d48feda83ca2b95de"></a><!-- doxytag: member="i2c.h::I2C_GEN_CALL_ADDRESS" ref="dc6e9d96bc63bb6d48feda83ca2b95de" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#dc6e9d96bc63bb6d48feda83ca2b95de">I2C_GEN_CALL_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">General Call Address. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#77224a8f9da46cd2718f114c3ec57769">I2C_RX_RING_BUFFER_BIT</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">[7]=128 [6]=64 [5]=32 [4]=16 [3]=8 [2]=4 [1]=2 [0]=invalid  <a href="#77224a8f9da46cd2718f114c3ec57769"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8bc3e4e8e2fd2dc19bdae5f08e6fa1c7"></a><!-- doxytag: member="i2c.h::I2C_DEV_ARRAY_SIZE" ref="8bc3e4e8e2fd2dc19bdae5f08e6fa1c7" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#8bc3e4e8e2fd2dc19bdae5f08e6fa1c7">I2C_DEV_ARRAY_SIZE</a>&nbsp;&nbsp;&nbsp;15</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of <a class="el" href="i2c_8h.html#cf2fb933aa13aab1ddba5fc38fc45fb5" title="Holds a list of device address&#39;s that are online.">I2cDevArray</a>[]. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0e182477044726763cc5aa5ac95e6231"></a><!-- doxytag: member="i2c.h::SMBUS_ARA" ref="0e182477044726763cc5aa5ac95e6231" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#0e182477044726763cc5aa5ac95e6231">SMBUS_ARA</a>&nbsp;&nbsp;&nbsp;0x0C</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SMBUS addressing mode. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f8ab9b292900a79c96c7315a2b26db35"></a><!-- doxytag: member="i2c.h::I2C_TIMEOUT_VALUE" ref="f8ab9b292900a79c96c7315a2b26db35" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#f8ab9b292900a79c96c7315a2b26db35">I2C_TIMEOUT_VALUE</a>&nbsp;&nbsp;&nbsp;0x80</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">uses bitwise-AND <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="25e3dfcc5d95e31fd51dba38a9e94752"></a><!-- doxytag: member="i2c.h::i2c_clr_intrpt_flag_" ref="25e3dfcc5d95e31fd51dba38a9e94752" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#25e3dfcc5d95e31fd51dba38a9e94752">i2c_clr_intrpt_flag_</a>()&nbsp;&nbsp;&nbsp;TWCR |= 0x80</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clear flag. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2b70a51206c3be4ab4497dc4c1cb1511"></a><!-- doxytag: member="i2c.h::i2c_enable_" ref="2b70a51206c3be4ab4497dc4c1cb1511" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#2b70a51206c3be4ab4497dc4c1cb1511">i2c_enable_</a>()&nbsp;&nbsp;&nbsp;TWCR |= 0x04</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable I2C module. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="29b991eefcdbad9ddf4bc2278642d60e"></a><!-- doxytag: member="i2c.h::i2c_disable_" ref="29b991eefcdbad9ddf4bc2278642d60e" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#29b991eefcdbad9ddf4bc2278642d60e">i2c_disable_</a>()&nbsp;&nbsp;&nbsp;TWCR &amp;= 0xF9</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable I2C module (use as regular I/O pins). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0d0b6d4484586fe99034dc6e875c6a77"></a><!-- doxytag: member="i2c.h::i2c_start_tx_" ref="0d0b6d4484586fe99034dc6e875c6a77" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#0d0b6d4484586fe99034dc6e875c6a77">i2c_start_tx_</a>()&nbsp;&nbsp;&nbsp;TWCR |= 0xA5</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends the start command. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="988b29abac8fe57d3e0d13df46c49b83"></a><!-- doxytag: member="i2c.h::i2c_no_start_" ref="988b29abac8fe57d3e0d13df46c49b83" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#988b29abac8fe57d3e0d13df46c49b83">i2c_no_start_</a>()&nbsp;&nbsp;&nbsp;TWCR &amp;= 0x5D</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Keep a repeated start from happening. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="25c03035c08e7fbc57e81ec1826a4f7a"></a><!-- doxytag: member="i2c.h::i2c_stop_tx_" ref="25c03035c08e7fbc57e81ec1826a4f7a" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#25c03035c08e7fbc57e81ec1826a4f7a">i2c_stop_tx_</a>()&nbsp;&nbsp;&nbsp;TWCR |= 0x10</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a stop command. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2d8b4e9f9d2f55f7ea783f2365997119"></a><!-- doxytag: member="i2c.h::i2c_ack_" ref="2d8b4e9f9d2f55f7ea783f2365997119" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#2d8b4e9f9d2f55f7ea783f2365997119">i2c_ack_</a>()&nbsp;&nbsp;&nbsp;TWCR |= 0x40</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends an acknowldege. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7f91c5845273f20bd893f7b6dfeb0b5b"></a><!-- doxytag: member="i2c.h::i2c_nack_" ref="7f91c5845273f20bd893f7b6dfeb0b5b" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#7f91c5845273f20bd893f7b6dfeb0b5b">i2c_nack_</a>()&nbsp;&nbsp;&nbsp;TWCR &amp;= 0xBF</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends a Not acknowldeged. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="06240200caa8796a83a1f74d58733414"></a><!-- doxytag: member="i2c.h::i2c_enable_intrpt_" ref="06240200caa8796a83a1f74d58733414" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#06240200caa8796a83a1f74d58733414">i2c_enable_intrpt_</a>()&nbsp;&nbsp;&nbsp;TWCR |= 0x01</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable I2C interrupts. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0ce172de179a78330905e6cceda548ea"></a><!-- doxytag: member="i2c.h::i2c_disable_intrpt_" ref="0ce172de179a78330905e6cceda548ea" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#0ce172de179a78330905e6cceda548ea">i2c_disable_intrpt_</a>()&nbsp;&nbsp;&nbsp;TWCR &amp;= 0xFE</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable I2C interrupts. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bd008c22944d96da6e2dab9e94179f1e"></a><!-- doxytag: member="i2c.h::i2c_enable_gc_" ref="bd008c22944d96da6e2dab9e94179f1e" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#bd008c22944d96da6e2dab9e94179f1e">i2c_enable_gc_</a>()&nbsp;&nbsp;&nbsp;TWAR |= 0x01</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable general call addressing. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cefc682e46fa4c34a81adc189aadc386"></a><!-- doxytag: member="i2c.h::i2c_disable_gc_" ref="cefc682e46fa4c34a81adc189aadc386" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#cefc682e46fa4c34a81adc189aadc386">i2c_disable_gc_</a>()&nbsp;&nbsp;&nbsp;TWAR &amp;= 0xFE</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable general call addressing. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e76c8807e355da5abb2c24dad6a10491"></a><!-- doxytag: member="i2c.h::i2c_set_address_" ref="e76c8807e355da5abb2c24dad6a10491" args="(x)" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#e76c8807e355da5abb2c24dad6a10491">i2c_set_address_</a>(x)&nbsp;&nbsp;&nbsp;TWAR = (x &amp; 0xFE)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pass in the 8-bit HW slave address. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d695fdd2f82671d793a9d260bae0ea6d"></a><!-- doxytag: member="i2c.h::i2c_rx_ring_next_" ref="d695fdd2f82671d793a9d260bae0ea6d" args="()" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#d695fdd2f82671d793a9d260bae0ea6d">i2c_rx_ring_next_</a>()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Safe increment of i2c ring pointer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#174b19b2e32d0753710973a74fa3c4f3">i2c_init_</a>(cntrl)&nbsp;&nbsp;&nbsp;TWCR=(cntrl &amp; 0x45); I2C_SET_BIT_RATE</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e25a9d09f39ecb6b39ae30a8787d7532"></a><!-- doxytag: member="i2c.h::I2CSTAT_T" ref="e25a9d09f39ecb6b39ae30a8787d7532" args="" -->
typedef enum <a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f">I2C_STATUS_ENUM</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#e25a9d09f39ecb6b39ae30a8787d7532">I2CSTAT_T</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used for declaring a variable that holds the I2C Transaction status. <br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f">I2C_STATUS_ENUM</a> { <br>
&nbsp;&nbsp;<a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85feceba296bdda2b90e8835c431fe7a72a">I2C_OK</a>, 
<a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f2e4932a1868432bff23103fac0127fdc">I2C_ERROR</a>, 
<a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f49e65f3960437d80b8328e7898cc90de">I2C_BUSY</a>, 
<a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f1056d6a4b037e383132309c2898a2fc8">I2C_TIMEOUT</a> =  0x04, 
<br>
&nbsp;&nbsp;<a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85fc9236302c39f6bdea17dd93cf68f11b1">I2C_LOST_ARB</a> =  0x08, 
<a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f1bc16cdfe75b42d38f7f4934ba636f7a">I2C_NO_RBUF</a> =  0x10, 
<a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85fa4fcab0e6eb00cab885410a13acb1109">I2C_CHKSUM_ERR</a> =  0x20
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Holds the status of the I2C state machine.  <a href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#c5bdf0f9e9d30f69489b8ae0b64b8300">i2c_dev_search</a> (uint8_t start, uint8_t num) __attribute__((warn_unused_result))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Search for <b>num</b> of devices beginning at <b>start</b>.  <a href="#c5bdf0f9e9d30f69489b8ae0b64b8300"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="10d07665f91c44b37adf64e37eda7430"></a><!-- doxytag: member="i2c.h::i2c_get_address" ref="10d07665f91c44b37adf64e37eda7430" args="(void) __attribute__((weak))" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#10d07665f91c44b37adf64e37eda7430">i2c_get_address</a> (void) __attribute__((weak))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Used by the ISR to update the hardware address. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#c0a9880009c6a3d3140b42134e008f02">i2c_write</a> (void *const data, const uint8_t n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A master write of <b>n</b> number of bytes from data in <b>*Data</b>.  <a href="#c0a9880009c6a3d3140b42134e008f02"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#f83055314c891d34f14dcc9db3e03b3b">i2c_read</a> (uint8_t DeviceAddress, void *const ReturnData, const uint8_t n)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A master read from <b>DeviceAddress</b> of <b>n</b> number of bytes to <b>*ReturnData</b>.  <a href="#f83055314c891d34f14dcc9db3e03b3b"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8c07468f489f61746e2c6c3b773ccab2"></a><!-- doxytag: member="i2c.h::I2cStatus" ref="8c07468f489f61746e2c6c3b773ccab2" args="" -->
volatile <a class="el" href="i2c_8h.html#e25a9d09f39ecb6b39ae30a8787d7532">I2CSTAT_T</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#8c07468f489f61746e2c6c3b773ccab2">I2cStatus</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global variable holds the status of the I2C module. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cf2fb933aa13aab1ddba5fc38fc45fb5"></a><!-- doxytag: member="i2c.h::I2cDevArray" ref="cf2fb933aa13aab1ddba5fc38fc45fb5" args="[I2C_DEV_ARRAY_SIZE]" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#cf2fb933aa13aab1ddba5fc38fc45fb5">I2cDevArray</a> [I2C_DEV_ARRAY_SIZE]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Holds a list of device address's that are online. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b43bbec6ee8cb607972e7e5be4b1fe14"></a><!-- doxytag: member="i2c.h::I2cOwnAddress" ref="b43bbec6ee8cb607972e7e5be4b1fe14" args="" -->
volatile uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#b43bbec6ee8cb607972e7e5be4b1fe14">I2cOwnAddress</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Variable holds 8-bit I2C address. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="98c7b0a3f5a5a51455eb273246a80286"></a><!-- doxytag: member="i2c.h::I2cRxBuff" ref="98c7b0a3f5a5a51455eb273246a80286" args="" -->
volatile <a class="el" href="structrb__fifo__struct__type.html">rbuff_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#98c7b0a3f5a5a51455eb273246a80286">I2cRxBuff</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the receive ring buffer used by the I2C module. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Driver for I2C bus communications. 
<p>
This module contains macros, structures, defines and functions to implement a master and slave I2C interface using the TWI.<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>John Myers </dd></dl>
<dl class="version" compact><dt><b>Version:</b></dt><dd>$Revision$ </dd></dl>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="174b19b2e32d0753710973a74fa3c4f3"></a><!-- doxytag: member="i2c.h::i2c_init_" ref="174b19b2e32d0753710973a74fa3c4f3" args="(cntrl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define i2c_init_          </td>
          <td>(</td>
          <td class="paramtype">cntrl&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;TWCR=(cntrl &amp; 0x45); I2C_SET_BIT_RATE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
I2C initialization macro.<br>
 F_TWI needs to be defined first. For example: -DF_TWI=100000UL 
</div>
</div><p>
<a class="anchor" name="77224a8f9da46cd2718f114c3ec57769"></a><!-- doxytag: member="i2c.h::I2C_RX_RING_BUFFER_BIT" ref="77224a8f9da46cd2718f114c3ec57769" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_RX_RING_BUFFER_BIT&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
[7]=128 [6]=64 [5]=32 [4]=16 [3]=8 [2]=4 [1]=2 [0]=invalid 
<p>
Valid defines: 1-7 
</div>
</div><p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="beac1ff552d84af056d915ddce78a85f"></a><!-- doxytag: member="i2c.h::I2C_STATUS_ENUM" ref="beac1ff552d84af056d915ddce78a85f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="i2c_8h.html#beac1ff552d84af056d915ddce78a85f">I2C_STATUS_ENUM</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Holds the status of the I2C state machine. 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="beac1ff552d84af056d915ddce78a85feceba296bdda2b90e8835c431fe7a72a"></a><!-- doxytag: member="I2C_OK" ref="beac1ff552d84af056d915ddce78a85feceba296bdda2b90e8835c431fe7a72a" args="" -->I2C_OK</em>&nbsp;</td><td>
Transaction completed succesfully. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="beac1ff552d84af056d915ddce78a85f2e4932a1868432bff23103fac0127fdc"></a><!-- doxytag: member="I2C_ERROR" ref="beac1ff552d84af056d915ddce78a85f2e4932a1868432bff23103fac0127fdc" args="" -->I2C_ERROR</em>&nbsp;</td><td>
Transaction failed. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="beac1ff552d84af056d915ddce78a85f49e65f3960437d80b8328e7898cc90de"></a><!-- doxytag: member="I2C_BUSY" ref="beac1ff552d84af056d915ddce78a85f49e65f3960437d80b8328e7898cc90de" args="" -->I2C_BUSY</em>&nbsp;</td><td>
Transaction in progress. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="beac1ff552d84af056d915ddce78a85f1056d6a4b037e383132309c2898a2fc8"></a><!-- doxytag: member="I2C_TIMEOUT" ref="beac1ff552d84af056d915ddce78a85f1056d6a4b037e383132309c2898a2fc8" args="" -->I2C_TIMEOUT</em>&nbsp;</td><td>
Transaction failed. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="beac1ff552d84af056d915ddce78a85fc9236302c39f6bdea17dd93cf68f11b1"></a><!-- doxytag: member="I2C_LOST_ARB" ref="beac1ff552d84af056d915ddce78a85fc9236302c39f6bdea17dd93cf68f11b1" args="" -->I2C_LOST_ARB</em>&nbsp;</td><td>
Transaction failed. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="beac1ff552d84af056d915ddce78a85f1bc16cdfe75b42d38f7f4934ba636f7a"></a><!-- doxytag: member="I2C_NO_RBUF" ref="beac1ff552d84af056d915ddce78a85f1bc16cdfe75b42d38f7f4934ba636f7a" args="" -->I2C_NO_RBUF</em>&nbsp;</td><td>
I2cRxBuff not initalized. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="beac1ff552d84af056d915ddce78a85fa4fcab0e6eb00cab885410a13acb1109"></a><!-- doxytag: member="I2C_CHKSUM_ERR" ref="beac1ff552d84af056d915ddce78a85fa4fcab0e6eb00cab885410a13acb1109" args="" -->I2C_CHKSUM_ERR</em>&nbsp;</td><td>
Transaction failed. </td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="c5bdf0f9e9d30f69489b8ae0b64b8300"></a><!-- doxytag: member="i2c.h::i2c_dev_search" ref="c5bdf0f9e9d30f69489b8ae0b64b8300" args="(uint8_t start, uint8_t num) __attribute__((warn_unused_result))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_dev_search           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>num</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Search for <b>num</b> of devices beginning at <b>start</b>. 
<p>
Searches for devices that will acknowldege and then places the address of the device in I2cDevArray[]. At most I2C_DEV_ARRAY_SIZE can be placed in I2cDevArray[]. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>8-bit address to start at </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>num</em>&nbsp;</td><td>Number of addresses to try </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>non-zero on error </dd></dl>

</div>
</div><p>
<a class="anchor" name="f83055314c891d34f14dcc9db3e03b3b"></a><!-- doxytag: member="i2c.h::i2c_read" ref="f83055314c891d34f14dcc9db3e03b3b" args="(uint8_t DeviceAddress, void *const ReturnData, const uint8_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_read           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>DeviceAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const &nbsp;</td>
          <td class="paramname"> <em>ReturnData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A master read from <b>DeviceAddress</b> of <b>n</b> number of bytes to <b>*ReturnData</b>. 
<p>
<b>DeviceAddress</b> is an <b>8-bit</b> number. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>DeviceAddress</em>&nbsp;</td><td>Device to read from or <b>I2C_ADDRESS_IN_ARRAY</b> to allow the first struct member or array index zero of <code>ReturnData</code> to be the address. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>*ReturnData</em>&nbsp;</td><td>destination </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>n</em>&nbsp;</td><td>number of bytes to write </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>I2cStatus </dd></dl>

</div>
</div><p>
<a class="anchor" name="c0a9880009c6a3d3140b42134e008f02"></a><!-- doxytag: member="i2c.h::i2c_write" ref="c0a9880009c6a3d3140b42134e008f02" args="(void *const data, const uint8_t n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t i2c_write           </td>
          <td>(</td>
          <td class="paramtype">void *const &nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>n</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
A master write of <b>n</b> number of bytes from data in <b>*Data</b>. 
<p>
The address is an <b>8-bit</b> number, which is index zero or the first member of the struct that is passed in to <b>*Data</b>. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>*data</em>&nbsp;</td><td>array or struct that holds data to be sent </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>n</em>&nbsp;</td><td>number of bytes to write </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>I2cStatus </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Jun 5 20:16:51 2009 for TWI_DEMO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7.1 </small></address>
</body>
</html>
